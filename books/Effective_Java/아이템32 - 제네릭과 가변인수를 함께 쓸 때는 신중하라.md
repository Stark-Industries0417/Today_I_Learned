
> [!info] 가변인수 메서드가 안전한지 판단 방법
> 가변인수 메서드를 호출할 때 varags 매개변수를 담는 제네릭 배열이 만들어지는데
> 메서드가 이 배열에 아무것도 저장하지 않고 그 배열의 참조가 밖으로 노출되지 않는다면
> 타입 안전하다.

``` java
static <T> T[] toArray(T... args) {
	return args;
}

이 메서드가 반환하는 배열의 타입은 메서드에 인수를 넘기는 컴파일 타임에 결정된다.
그 시점에 컴파일러에게 충분한 정보가 주어지지 않아 타입을 잘못 판단할 수 있다.
따라서 자신의 varags 매개변수 배열을 그대로 반환하면 힙 오염을 
이 메서드를 호출한 쪽의 콜스택으로까지 전이할 수 잇다.
```

## 수정해야 하는 varags 메서드
- varargs 매개변수 배열에 아무것도 저장하지 않는다.
- 그 배열의 참조를 노출하지 않는다.

> [!summary] 
> 제네릭 varags 매개변수는 타입 안전하지 않지만, 허용된다. 사용하고자 한다면
> 먼저 그 메서드가 타입 안전한지 확인한 다음 @SafeVarags 애너테이션을 달아 
> 불편함이 없게끔 하자

#effective-java 