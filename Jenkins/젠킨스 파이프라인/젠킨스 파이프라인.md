# 젠킨스 파이프라인

젠킨스 파이프라인 사용 시 젠킨스 구축 단계를 코드로 작성 가능

구축 단계 ⇒ 컴파일 구축, 테스트, 배포 등을 코드로 작성하는것 의미

<aside>
💡 작업을 컴파일 → 테스트 실행 → 코드를 서버, 스테이징 서버, 프로덕션 서버에 저장 → 코드를 버전 관리에 넣음
⇒ 이 주기를 자동화하는 것이 핵심

</aside>

## 젠킨스 파이프라인과 젠킨스 잡 DSL의 차이

> 둘 다 모든 CI/CD를 코드로 작성 가능
> 

### 젠킨스 잡DSL

- 선언적 파이프라인
- 잡DSL은 새로운 파이프라인 작업 생성 가능
- 사용자가 작성한 코드를 기반으로 새 작업 생성
- seed project → 새 작업 생성 하듯이
- 젠킨스 자유유형 프로젝트에 원하는 구축 단계 넣을 수 있음

### 젠킨스 파이프 라인

- 스크립트 파이프라인 → 그루비 작성
- 작업 유형
- 프로젝트의 구축/테스트/배포를 처리하는 파이프라인 작업 생성 가능
- 젠킨스 파이프 라인의 기능인
Organizatioin folder 사용하여 프로젝트 저장소 감지 가능 ⇒ 새 작업 추가할 필요 없음

구출해야 할 다양한 서비스 있을 수 있고 모든 사용 키 마다 다른 접근 방식 필요할 수 있음

## 젠킨스 파이프라인 예제(메이븐으로 작성)

<aside>
💡 메이븐 이란?
- 아파치 소프트웨어 재단에서 개발하는 Java 기반 프로젝트로 소프트웨어 라이플사이클 관리 위한 빌드 도구
컴파일과 빌드를 동시에 수행, 테스트 병행하거나 서버 측 의존성 자원을 관리할 수 있는 환경 제공

</aside>

```python
node {            # 작업이 실행될 젠킨스 워커 노드에 영향 줌(노드만 지정, 작업 수행에 대해선 정의안함) 인자 없이 사용하면 이 프로젝트가 어떤 노드에서든 실행될 수 있음
									# 현재 노드가 하나뿐이기 때문에 마스터 노드에서 실행됨
		def mvnHome   # def로 mvnHome 변수 선언
		
		# stage엔 구축단계(구축, 테스트, 배포) 정의, 예제엔 준비, 구축, 결과 단계로 진행
		stage('Preparation') {
				git 'https://github.com/wardviaene/java-demo.git'
				mvnHome = tool 'M3'  # 변수 정의, 도구 키워드는 이 메이븐 도구의 홈 디렉토리 찾을 수 있는지 확인
		}
		stage('Build') {
				if(isUnix) {
		        # 메이븐 실행 파일의 경로 구축
						# '${mvnHome}/bin/mvn' << 메이븐 도구가 있는 위치
						sh "'${mvnHome}/bin/mvn' -Dmaven.test.failure.ignore 
clean package" # << 수행할 작업은 패키지를 정리하고 패키지화하는 작업
						} else {
								# 메이븐 실행 파일의 경로 구축
								bat(/"${mvnHome}\bin\mvn" -Dmaven.test.failure.ignore
clean package/}
			}
}

		stage('Results') {
				# 패키징된 파일 보관
				junit '**/target/surefire-reports/TEST-*.xml'
				archive 'target/*.jar'
		}
```

[NodeJS 및 도커 이용한 젠킨스 파이프라인](%E1%84%8C%E1%85%A6%E1%86%AB%E1%84%8F%E1%85%B5%E1%86%AB%E1%84%89%E1%85%B3%20%E1%84%91%208b03f/NodeJS%20%E1%84%86%E1%85%B5%E1%86%BE%20a9771.md)